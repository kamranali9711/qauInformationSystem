<!DOCTYPE html>
<html>

<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
<link href="/css/viewscholarship.css" rel="stylesheet">

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<meta http-equiv="Content-Security-Policy" content="block-all-mixed-content" />

</head>

<body >
	<div>

		<div>
			<img src="/images/qau1.png" height="100px" width="700px" style="margin-left: 300px">

		</div>
		<div >
			<div class="nav">
				<ul>
					<li class="Dashbord"><a href="/page/dashbord">Dashbord</a></li>
					<li class="Schorarship"><a href="/page/scholarships">Schorarship</a></li>
					<li class="Transport"><a href="/page/transports">Transport</a></li>
					<li class="Dining"><a href="/page/dining">Dining</a></li>
					<li class="Program"><a href="/page/notification">Notification</a></li>
					<li class="Events"><a href="/page/events">Events</a></li>
					<li class="News"><a href="/page/news">News</a></li>
					<li class="News"><a href="/page/admission">Admission</a></li>
					<li class="Logout" style="float:right"><a href="/">Logout</a></li>
					<div class="dropdown">
						<button class="dropbtn">Data View 
      <i class="fa fa-caret-down"></i>
    </button>
						<div class="dropdown-content">
							<a href="/page/viewscholarships">Schorarship Data</a>
							<a class="active" href="/page/viewstransport">Transport Data</a>
							<a href="/page/viewsdining">Dining Data</a>
							<a href="/page/viewsevent">Events Data</a>
							<a href="/page/viewnews">News Data</a>
							<a href="/page/viewadmission">Admission Data</a>
	  <a href="/page/viewnotification">Notification Data</a>

						</div>
					</div>


				</ul>

			</div>
			<h1 style="margin-left:40%">Data of Transport</h1>

	<table id="data" class="table table-bordered table-striped" style="width:90%; margin-left:auto; margin-right:auto" >
    <tr>
    <th width="20%">route</th>
    <th width="10%">busno</th>
    <th width="40%">detail</th>
    <th width="10%">time</th>
    <th width="5%">Update</th>
    <th width="5%">Delete</th>
 
        </tr>
        </table>
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content"></div>
            </div>
            <div class="modal-dialog">
                <div class="modal-content"></div>
            </div>
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"> <span aria-hidden="true" class="">Ã—   </span><span class="sr-only">Close</span>
        
                        </button>
                         <h4 class="modal-title" id="myModalLabel">Modal title</h4>
        
                    </div>
                    <div class="modal-body"></div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div>
                </div>
            </div>
        </div>




        <script>
                            $(".btn[data-target='#myModal']").click(function() {
                    var columnHeadings = $("thead th").map(function() {
                                return $(this).text();
                            }).get();
                    columnHeadings.pop();
                    var columnValues = $(this).parent().siblings().map(function() {
                                return $(this).text();
                    }).get();
                var modalBody = $('<div id="modalContent"></div>');
                var modalForm = $('<form role="form" name="modalForm" action="putYourPHPActionHere.php" method="post"></form>');
                $.each(columnHeadings, function(i, columnHeader) {
                    var formGroup = $('<div class="form-group"></div>');
                    formGroup.append('<label for="'+columnHeader+'">'+columnHeader+'</label>');
                    formGroup.append('<input class="form-control" name="'+columnHeader+i+'" id="'+columnHeader+i+'" value="'+columnValues[i]+'" />'); 
                    modalForm.append(formGroup);
                });
                modalBody.append(modalForm);
                $('.modal-body').html(modalBody);
                });
                $('.modal-footer .btn-primary').click(function() {
                $('form[name="modalForm"]').submit();
                });
        
        
        
        </script>
	<script>
populateTable();
function populateTable(){
        var mydata;
        var userdata;
      $(document).ready(function(){
        console.log('Unable to put data');

       
                $.getJSON("https://qauinformationsystem.herokuapp.com/api/routes", function(data){
                    console.log(data);
                 
  
                    $.each(data, function(i, field){
                   
                       $('#data').append('<tr><td>'+field.route+'</td><td>'+field.detail+
                        '</td><td>'+field.busno+'</td><td>'+field.time+' </td><td><a href="#" id="btn1" class="deletetransport"   rel="' + this._id + '" >delete</a></td><td> <a href=""  class="btn btn-warning"  class="btn btn-success" data-toggle="modal" data-target="#myModal"contenteditable="false"><span class="glyphicon glyphicon-edit"></span>Update</a></td></tr>' 
            
                    );

                   
                       
                        });
                })
               
            });
          }



	</script>

<script>
	$('#data tbody').on('click', 'td a.deletetransport', function deletetransport(event){


    event.preventDefault();
    // Pop up a confirmation dialog
    var confirmation = confirm('Are you sure you want to delete this user?');
    // Check and make sure the user confirmed
    if (confirmation === true) {
        // If they did, do our delete
        $.ajax({
            method:'DELETE',
            type: 'DELETE',
            url: '/api/routes/delete/'  + $(this).attr('rel'),

        }).done(function( response) {
          
           
          
                      // Check for a successful (blank) response
          
                      if (response.msg == '') {
                       
          
                      }
          
                      else {
                     
                        alert('sucessfully deleted!');
                        location.reload();
                        
          
                      }

});
}else {

// If they said no to the confirm, do nothing

        return false;

    }
})
</script>

</body>

</html>